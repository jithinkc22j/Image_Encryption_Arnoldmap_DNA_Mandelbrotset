% Encryption -Function
% -----------------------------------------------------------------------------------------------------------------------------------  

function anss=encryption(a)

 % STEP 1 : input original image 

   ori=entropy(a);
   figure;
   imshow(a);title('lena original');
% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 2: Decompose in to R,G,B
  
   
   
% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 3: Chaos sequence generation.

   X1=arnoldx(x,y);
   X2=arnoldx(x,y);
   X3=arnoldx(x,y);
  
   % Normalized chaotic sequence (arnold).
   
     
% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 4: DNA Encoding on R,G,B components.

   for i= 1:65536
     DR(i)=DNA_encode_rule01(R(i));
     
   end
% -----------------------------------------------------------------------------------------------------------------------------------  

%STEP 5:DNA Encoding on Chaotic sequence S1,S2,S3.

   D1=string();
   
   for i= 1:65536
     D1(i)=DNA_encode_rule01(S1(i));
     
   end
% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 6: DNA xor operation on R,G,B and chaotic sequence (S1,S2,S3):

 
   for i=1:65536  
     XDR(i)=DNA_xor(DR(i),D1(i));
     
   end
% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 7: Calculating Hamming distance on R,G,B with respect to chaotic sequence:

 
   for i=1:65536
     HR(i)=disthamming(R(i),S1(i));
     
   end
% -----------------------------------------------------------------------------------------------------------------------------------     

% for decryption 

% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 8:DNA Encoding on Hamming distance.
  
 
   for i=1:65536
     DHR(i)=DNA_encode_rule01(HR(i),1);
     
   end
% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 9: DNA XOR operation on Encoded Hamming distance and Encoded Chaotic Sequence:

   
    for i=1:65536
      XR(i)=DNA_xor(DHR(i),D1(i));
      
    end
% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 10 : DNA Decoding on  XOR- Hamming and Chaotic:

   
% -----------------------------------------------------------------------------------------------------------------------------------  

% STEP 11: confusion and permutation by mandelbrotset  
  
 
   for i=1:65536;
     rxt(i)=DNA_decode_rule01(XDR(i),1);
    
   end
  -------------------------------------------------------------------------------------------------------  
   
   % Calling Mandelbrot set function
     
      mdset=md();
      
      % find max element
      % 1=coloumn_min, 2=row_min
     
     for j=1:256;
       mdm(j)=maximum(mdset,j,1);
       
% -----------------------------------------------------------------------------------------------------------------------------------  
      
      % shift to right with  mdm check
      
   
% -----------------------------------------------------------------------------------------------------------------------------------       

% STEP 12:DNA diffusion process

    SR=reshape(rxtp,1,65536);
    
   
    % diffusion using XORed Hamming and Confused R,G,B
    
    
     
% -----------------------------------------------------------------------------------------------------------------------------------           
         figure;
         imshow(CR);title('diffused red');
         imwrite(CR,'diffused red.png'); 
         
     
% -----------------------------------------------------------------------------------------------------------------------------------          
       
         
         figure;
         imshow(cipherimage);title('cipherimage');
        
        
         disp('Created by JITHIN K C');
         anss=ric;
end
% -----------------------------------------------------------------------------------------------------------------------------------  
